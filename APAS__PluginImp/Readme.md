# RIGOL DP800s 可编程直流电源插件使用指南



## 界面说明

![mainFrame](\Resources\mainFrame.png)

操作界面包含三个通道，从左至右依次为通道1~通道3.

每个通道中的项目自上而下依次为：

| 项目       | 说明                   |
| ---------- | ---------------------- |
| Voltage(V) | 电压实时测量值，单位 V |
| Current(A) | 电流实时测量值，单位 A |
| Power(W)   | 功率实时测量值，单位 W |
| Voltage(V) | 电压设置，单位 V       |
| OVP(V)     | 过压保护，单位 V       |
| OCP(A)     | 过流保护，单位 A       |
| ON/OFF     | 打开或关闭电源输出     |



## 如何通过界面控制电源

### 设置电压、OVP、OCP

在文本框内输入设置值，然后点击文本框右侧的按钮，将值写入电源。



### 打开或关闭电源输出

点击按钮 `ON`  或 `OFF` 可打开或关闭对应的通道的输出。





## 如何使用脚本操作

可通过两种方式进行控制：

- 通过 APAS 的用户脚本编辑器
- 通过外部脚本



### 通过用户脚本编辑器

#### 设置电源参数及控制输出

1. 打开 `脚本编辑器`
2. 左侧的指令选择窗口里找到 `插件` -> `插件控制` ，并将其拖入脚本列表
3. 在脚本列表中选中刚才拖入的 `插件控制` 指令
4. 在右侧的属性窗口中找到 `插件` 栏位，并选择 `RIGOL DP800s`
5. 在 `参数` 栏位中填写控制参数



> 关于如何填写 *控制参数*，请参考 *通过外部脚本* 章节



#### 读取指定通道测量值

1. 打开 `脚本编辑器`
2. 左侧的指令选择窗口里找到 `变量` -> `设备测量` ，并将其拖入脚本列表
3. 在脚本列表中选中刚才拖入的 `设备测量` 指令
4. 在右侧的属性窗口中找到 `设备` 栏位，并选择 `RIGOL DP800s,CHx电压` 或 `RIGOL DP800s,CHx电流`
5. 在 `变量名` 栏位中填写用于保存测量值的变量名称



> 设备名称中的 ***CHx*** 表示通道，请根据需要进行选择



### 通过外部脚本

#### 设置电源参数及控制输出

在C#脚本中调用下述函数，可对本插件进行操作：

```c#
apas.__SSC_EquipmentPluginControl("RIGOL DP800s", "参数");
```



关于支持的 `参数`，请参考下表：

| 参数                 | 说明                   | 示例                                                         |
| -------------------- | ---------------------- | ------------------------------------------------------------ |
| ON [1&#124;2&#124;3&#124;ALL]    | 打开指定通道或所有通道 | // 打开通道1电源输出<br />apas.__SSC_EquipmentPluginControl("RIGOL DP800s", **"ON 1"**); |
| OFF [1&#124;2&#124;3&#124;ALL]   | 关闭指定通道或所有通道 | // 关闭通道2电源输出<br />apas.__SSC_EquipmentPluginControl("RIGOL DP800s", **"OFF 2"**); |
| VLEV [1&#124;2&#124;3&#124;],value | 设置指定通道的电压值   | // 将通道1输出电压设置为 3.3V<br />apas.__SSC_EquipmentPluginControl("RIGOL DP800s", **"VLEV 1,3.3"**); |
| OVP [1&#124;2&#124;3&#124;],value  | 设置指定通道的过压保护 | // 将通道1过压保护设置为 3.3V<br />apas.__SSC_EquipmentPluginControl("RIGOL DP800s", **"OVP 1,3.3"**); |
| OCP [1&#124;2&#124;3&#124;],value  | 设置指定通道的电流值   | // 将通道3输出电压设置为 3.3V<br />apas.__SSC_EquipmentPluginControl("RIGOL DP800s", **"OCP 3,3.3"**); |



#### 读取指定通道测量值

在APAS系统中，DP800s的每个通道中的电压和电流测量项均被抽象为一台独立的设备，并分配了设备名称。可通过这些指定的设备名称读取指定的测量值。

```c#
// 读取通道1电压测量值
apas.__SSC_MeasurableDevice_Read("RIGOL DP800s,CH1电压");
    
// 读取通道1电流测量值
apas.__SSC_MeasurableDevice_Read("RIGOL DP800s,CH1电流");

// 读取通道2电压测量值
apas.__SSC_MeasurableDevice_Read("RIGOL DP800s,CH2电压");
    
// 读取通道2电流测量值
apas.__SSC_MeasurableDevice_Read("RIGOL DP800s,CH2电流");

// 读取通道3电压测量值
apas.__SSC_MeasurableDevice_Read("RIGOL DP800s,CH3电压");
    
// 读取通道3电流测量值
apas.__SSC_MeasurableDevice_Read("RIGOL DP800s,CH3电流");
```

